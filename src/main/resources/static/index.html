<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loto Master AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary-color: #0d6efd;
            --secondary-bg: #f8f9fa;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f2f5;
            color: #333;
        }
        /* Navbar stylis√©e */
        .navbar-brand {
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        /* Cartes douces */
        .card {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover {
            box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        }

        /* Onglets */
        .nav-pills .nav-link.active {
            background-color: var(--primary-color);
            font-weight: 600;
        }
        .nav-link { color: #666; }

        /* Heatmap Grid */
        .heatmap-cell {
            width: 45px; height: 45px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 8px;
            font-weight: bold; color: white;
            font-size: 0.9rem;
            transition: transform 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .heatmap-cell:hover { transform: scale(1.15); z-index: 10; }

        /* Stats Listes */
        .small-list .list-group-item {
            font-size: 0.9rem;
            padding: 0.6rem 1rem;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            background: transparent;
        }
        .small-list .list-group-item:last-child { border-bottom: 0; }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm mb-4">
    <div class="container">
        <a class="navbar-brand" href="#"><i class="bi bi-dice-5-fill me-2"></i>Loto Master AI</a>
        <span class="navbar-text text-white-50 small d-none d-md-block">Analysez, Pronostiquez, Gagnez.</span>
    </div>
</nav>

<div class="container pb-5">

    <div class="card p-4 mb-4 bg-white">
        <div class="d-flex justify-content-center flex-wrap gap-3">
            <button class="btn btn-outline-primary btn-lg rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#modalAstro">
                <i class="bi bi-stars me-2"></i>Mon Profil Astral
            </button>
            <a href="https://www.fdj.fr/jeux-de-tirage/loto" target="_blank" class="btn btn-success btn-lg rounded-pill px-4 shadow-sm fw-bold">
                <i class="bi bi-ticket-perforated-fill me-2"></i>Jouer sur FDJ.fr
            </a>
        </div>
    </div>

    <div class="modal fade" id="modalAstro" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="bi bi-moon-stars-fill me-2"></i>Analyse Astrologique</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body bg-light">
                    <form id="formAstro">
                        <div class="row g-2 mb-3">
                            <div class="col-6">
                                <label class="form-label small fw-bold text-muted">Date Naissance</label>
                                <input type="date" id="astroDate" class="form-control" required>
                            </div>
                            <div class="col-6">
                                <label class="form-label small fw-bold text-muted">Heure</label>
                                <input type="time" id="astroTime" class="form-control" required>
                            </div>
                            <div class="col-6">
                                <label class="form-label small fw-bold text-muted">Ville</label>
                                <input type="text" id="astroVille" class="form-control" placeholder="ex: Paris" required>
                            </div>
                            <div class="col-6">
                                <label class="form-label small fw-bold text-muted">Signe</label>
                                <select id="astroSigne" class="form-select" required>
                                    <option value="BELIER">‚ôà B√©lier</option>
                                    <option value="TAUREAU">‚ôâ Taureau</option>
                                    <option value="GEMEAUX">‚ôä G√©meaux</option>
                                    <option value="CANCER">‚ôã Cancer</option>
                                    <option value="LION">‚ôå Lion</option>
                                    <option value="VIERGE">‚ôç Vierge</option>
                                    <option value="BALANCE">‚ôé Balance</option>
                                    <option value="SCORPION">‚ôè Scorpion</option>
                                    <option value="SAGITTAIRE">‚ôê Sagittaire</option>
                                    <option value="CAPRICORNE">‚ôë Capricorne</option>
                                    <option value="VERSEAU">‚ôí Verseau</option>
                                    <option value="POISSONS">‚ôì Poissons</option>
                                </select>
                            </div>
                        </div>

                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-outline-primary">
                                üîÆ Voir mes num√©ros astraux
                            </button>
                            <button type="button" id="btnHybridAlgo" class="btn btn-primary fw-bold shadow-sm py-2">
                                üöÄ Lancer l'Algorithme Hybride
                            </button>
                        </div>
                    </form>

                    <div id="astroResult" class="d-none mt-4 text-center fade-in">
                        <div class="p-3 bg-white rounded-3 shadow-sm border">
                            <h6 class="text-primary fw-bold text-uppercase mb-1" id="astroTitle">-</h6>
                            <p class="small text-muted mb-3">Chemin de Vie : <strong id="astroPath"></strong> | √âl√©ment : <strong id="astroElement"></strong></p>

                            <div class="alert alert-info py-2 fst-italic small mb-3" id="astroPhrase"></div>

                            <p class="mb-2 fw-bold small text-uppercase text-secondary">Vos Num√©ros Porte-Bonheur</p>
                            <div class="d-flex justify-content-center gap-2 mb-3" id="astroBalls"></div>

                            <button class="btn btn-sm btn-dark w-100" id="btnCopyAstro">
                                <i class="bi bi-arrow-down-circle me-1"></i> Copier dans le simulateur
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion mb-4 shadow-sm rounded-4 overflow-hidden" id="gestionAccordion">
        <div class="accordion-item border-0">
            <h2 class="accordion-header" id="headingImport">
                <button class="accordion-button collapsed fw-bold text-secondary bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapseImport">
                    <i class="bi bi-database-fill-gear me-2 text-primary"></i> Gestion des Donn√©es & Import
                </button>
            </h2>
            <div id="collapseImport" class="accordion-collapse collapse" data-bs-parent="#gestionAccordion">
                <div class="accordion-body bg-light">
                    <div class="row g-4">
                        <div class="col-md-6 border-end">
                            <h6 class="fw-bold text-primary mb-3">Importer un CSV Historique</h6>
                            <div class="input-group">
                                <input type="file" class="form-control" id="csvFile">
                                <button class="btn btn-primary" id="btnImport">Importer</button>
                            </div>
                            <small class="text-muted d-block mt-2">Compatible formats FDJ et Texte.</small>
                        </div>
                        <div class="col-md-6">
                            <h6 class="fw-bold text-success mb-3">Ajout Manuel Rapide</h6>
                            <button class="btn btn-outline-success w-100" type="button" data-bs-toggle="collapse" data-bs-target="#formManuelCollapse">
                                <i class="bi bi-pencil-square me-2"></i>Saisir un tirage r√©cent
                            </button>
                            <div class="collapse mt-3" id="formManuelCollapse">
                                <form id="formManuel" class="card card-body border-0 shadow-sm">
                                    <input type="date" class="form-control mb-2" id="mDate" required>
                                    <div class="input-group mb-2">
                                        <input type="number" class="form-control text-center" id="mB1" placeholder="N1">
                                        <input type="number" class="form-control text-center" id="mB2" placeholder="N2">
                                        <input type="number" class="form-control text-center" id="mB3" placeholder="N3">
                                        <input type="number" class="form-control text-center" id="mB4" placeholder="N4">
                                        <input type="number" class="form-control text-center" id="mB5" placeholder="N5">
                                    </div>
                                    <input type="number" class="form-control border-danger text-danger fw-bold mb-2" id="mChance" placeholder="Chance (1-10)">
                                    <button type="submit" class="btn btn-success w-100 btn-sm">Enregistrer</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-light border d-flex align-items-center justify-content-center shadow-sm py-2 mb-4" role="alert" id="infoPeriode" style="display: none !important;">
        <i class="bi bi-calendar-range me-2 text-primary"></i>
        <span class="small">Analyse de <strong id="nbTirages">0</strong> tirages (<span class="text-primary" id="dateMin">-</span> au <span class="text-primary" id="dateMax">-</span>)</span>
    </div>

    <div class="card mb-5">
        <div class="card-header bg-white py-3 border-bottom-0">
            <h5 class="mb-0 fw-bold text-primary"><i class="bi bi-cpu-fill me-2"></i>Simulateur & Pronostics</h5>
        </div>
        <div class="card-body bg-light rounded-bottom-4">
            <form id="formSimulateur">
                <div class="row g-2 align-items-end">
                    <div class="col-md-3">
                        <label class="small fw-bold text-muted mb-1">Date vis√©e</label>
                        <input type="date" class="form-control shadow-sm" id="simDate" required>
                    </div>

                    <div class="col"><input type="number" class="form-control text-center fw-bold sim-input shadow-sm" placeholder="N1"></div>
                    <div class="col"><input type="number" class="form-control text-center fw-bold sim-input shadow-sm" placeholder="N2"></div>
                    <div class="col"><input type="number" class="form-control text-center fw-bold sim-input shadow-sm" placeholder="N3"></div>
                    <div class="col"><input type="number" class="form-control text-center fw-bold sim-input shadow-sm" placeholder="N4"></div>
                    <div class="col"><input type="number" class="form-control text-center fw-bold sim-input shadow-sm" placeholder="N5"></div>

                    <div class="col-md-5">
                        <div class="d-flex gap-2">
                            <div class="input-group shadow-sm">
                                <span class="input-group-text bg-warning text-dark border-warning fw-bold">Qt√©</span>
                                <select class="form-select border-warning bg-white" id="pronoCount" style="max-width: 80px;">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="5" selected>5</option>
                                    <option value="10">10</option>
                                </select>
                                <button type="button" id="btnMagic" class="btn btn-warning fw-bold text-dark flex-grow-1">
                                    <i class="bi bi-magic me-1"></i> G√©n√©rer
                                </button>
                            </div>
                            <button type="submit" class="btn btn-dark shadow-sm" title="Analyser la saisie manuelle">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </form>

            <div id="pronoResult" class="mt-4 d-none fade-in">
                <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
                    <h6 class="text-primary fw-bold mb-0">üîÆ Pronostics IA pour <span id="pronoDate"></span></h6>
                    <button class="btn btn-sm btn-link text-decoration-none text-muted" onclick="document.getElementById('pronoResult').classList.add('d-none')">Fermer</button>
                </div>
                <div id="pronoList" class="row g-3">
                </div>
            </div>

            <div id="simResult" class="mt-4 d-none fade-in"></div>
        </div>
    </div>

    <div class="d-flex align-items-center mb-4">
        <hr class="flex-grow-1 border-secondary opacity-25">
        <span class="mx-3 text-secondary text-uppercase fw-bold small"><i class="bi bi-bar-chart-fill me-2"></i>Analyse Statistique</span>
        <hr class="flex-grow-1 border-secondary opacity-25">
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-white pt-3 pb-0 border-bottom-0">
            <div class="row mb-3">
                <div class="col-md-12 text-center">
                    <div class="btn-group shadow-sm" role="group">
                        <button type="button" class="btn btn-outline-primary btn-filter active px-4" data-jour="">Tous</button>
                        <button type="button" class="btn btn-outline-primary btn-filter px-3" data-jour="MONDAY">Lundi</button>
                        <button type="button" class="btn btn-outline-primary btn-filter px-3" data-jour="WEDNESDAY">Mercredi</button>
                        <button type="button" class="btn btn-outline-primary btn-filter px-3" data-jour="SATURDAY">Samedi</button>
                    </div>
                </div>
            </div>

            <ul class="nav nav-tabs justify-content-center border-bottom-0" id="graphTabs" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active rounded-top-3 px-4" id="tab-main" data-bs-toggle="tab" data-target="main" type="button">üîµ Boules (1-49)</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link text-danger rounded-top-3 px-4" id="tab-chance" data-bs-toggle="tab" data-target="chance" type="button">üî¥ Chance (1-10)</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link text-success rounded-top-3 px-4" id="tab-heat" data-bs-toggle="tab" data-target="heat" type="button">üå°Ô∏è Heatmap</button>
                </li>
            </ul>
        </div>

        <div class="card-body bg-white rounded-bottom-4">

            <div id="searchContainerMain" class="mb-3 search-container" style="max-width: 500px; margin: 0 auto;">
                <div class="input-group shadow-sm">
                    <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-muted"></i></span>
                    <input type="text" class="form-control border-start-0" id="searchNum" placeholder="Filtrer les boules (ex: 7, 24)...">
                    <button class="btn btn-outline-secondary btn-reset" type="button"><i class="bi bi-x-lg"></i></button>
                </div>
            </div>

            <div id="searchContainerChance" class="mb-3 search-container d-none" style="max-width: 500px; margin: 0 auto;">
                <div class="input-group shadow-sm">
                    <span class="input-group-text bg-white border-end-0 text-danger"><i class="bi bi-search"></i></span>
                    <input type="text" class="form-control border-start-0" id="searchChance" placeholder="Filtrer Chance (ex: 10)...">
                    <button class="btn btn-outline-secondary btn-reset" type="button"><i class="bi bi-x-lg"></i></button>
                </div>
            </div>

            <div class="position-relative" style="min-height: 300px;">
                <canvas id="scatterChart"></canvas>
            </div>

            <div id="heatmapContainer" class="d-none mt-4 fade-in">
                <div class="d-flex justify-content-center flex-wrap gap-2" id="heatmapGrid" style="max-width: 700px; margin: 0 auto;"></div>
                <div class="d-flex justify-content-center mt-3 small text-muted">
                    <span class="me-3"><i class="bi bi-circle-fill text-primary"></i> Froid</span>
                    <span class="me-3"><i class="bi bi-circle-fill text-success"></i> Neutre</span>
                    <span><i class="bi bi-circle-fill text-danger"></i> Chaud</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4 mb-4">
        <div class="col-lg-6">
            <div class="card h-100 shadow-sm border-primary border-opacity-25">
                <div class="card-header bg-primary bg-opacity-10 text-primary border-bottom-0 py-3">
                    <h6 class="mb-0 fw-bold"><i class="bi bi-grid-3x3 me-2"></i>Top Boules (1-49)</h6>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-6">
                            <span class="badge bg-success bg-opacity-10 text-success w-100 mb-2 py-2">üî• En Forme</span>
                            <ul class="list-group list-group-flush small-list" id="mainTopFreq"></ul>
                        </div>
                        <div class="col-6">
                            <span class="badge bg-danger bg-opacity-10 text-danger w-100 mb-2 py-2">‚è≥ En Retard</span>
                            <ul class="list-group list-group-flush small-list" id="mainTopGap"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card h-100 shadow-sm border-danger border-opacity-25">
                <div class="card-header bg-danger bg-opacity-10 text-danger border-bottom-0 py-3">
                    <h6 class="mb-0 fw-bold"><i class="bi bi-star me-2"></i>Top Chance (1-10)</h6>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-6">
                            <span class="badge bg-success bg-opacity-10 text-success w-100 mb-2 py-2">üî• En Forme</span>
                            <ul class="list-group list-group-flush small-list" id="chanceTopFreq"></ul>
                        </div>
                        <div class="col-6">
                            <span class="badge bg-danger bg-opacity-10 text-danger w-100 mb-2 py-2">‚è≥ En Retard</span>
                            <ul class="list-group list-group-flush small-list" id="chanceTopGap"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/app.js"></script>
</body>
</html>