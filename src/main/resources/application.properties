# =====================
# SERVER
# =====================
server.port=${PORT:8080}

# =====================
# BASE DE DONNEES
# =====================
# Docker ecrasera ces valeurs, mais on garde des valeurs par defaut coherentes
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/lotodb}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:loto}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:admin}

spring.jpa.hibernate.ddl-auto=update
# En Spring Boot 3, le dialecte est detecte automatiquement.
# On peut le commenter pour eviter des warnings si vous changez de version de Postgres.
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# =====================
# UPLOAD DE FICHIERS
# =====================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# =====================
# CONFIGURATION EMAIL (GMAIL)
# =====================
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${SPRING_MAIL_USERNAME:tonycoloricchio01@gmail.com}
spring.mail.password=${SPRING_MAIL_PASSWORD:spupqbtuiobzazir}

spring.mail.protocol=smtp
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# --- FIX CRITIQUE SSL (VPS/DOCKER) ---
# Ces lignes remplacent le code Java complexe pour le SSL.
# Elles disent a Spring Mail de faire confiance a Gmail sans chercher le certificat systeme (qui plante chez vous).
spring.mail.properties.mail.smtp.ssl.trust=*
spring.mail.properties.mail.smtp.ssl.checkserveridentity=false
# -------------------------------------

spring.mail.properties.mail.debug=true

# ==========================================
# PLANNING DES JOBS (CRON)
# ==========================================
# Format: Seconde Minute Heure JourMois Mois JourSemaine
loto.jobs.cron.fdj-recovery=0 0 22 * * MON,WED,SAT
loto.jobs.cron.gen-pronos=0 0 17 * * MON,WED,SAT
loto.jobs.cron.send-emails=0 0 8 * * MON,WED,SAT
loto.jobs.cron.budget-alert=0 0 9 * * MON
loto.jobs.cron.user-cleanup=0 0 4 * * *
loto.jobs.cron.db-cleanup=0 0 3 * * SUN

# =====================
# CONFIGURATION METIER
# =====================
app.loto.recipient=${APP_LOTO_RECIPIENT:tonycoloricchio01@gmail.com}

# =====================
# SECURITE
# =====================
# On variabilise aussi la cle pour pouvoir la changer en Prod via le .env sans recompiler
loto.security.remember-key=${LOTO_SECURITY_REMEMBER_KEY:UneSuperCleTresLongueEtAleatoirePourLeDev123456}

# =====================
# API FDJ
# =====================
fdj.api.url=https://www.fdj.fr/api/service-draws/v1/games/loto/draws
